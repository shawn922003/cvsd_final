# 實作 (63, 51) bch decoder
# p(x) = x^6 + x + 1 is the primitive polynomial for GF(2^6)
# phi1(x) = x^6 + x + 1
# phi2(x) = x^6 + x + 1
# phi3(x) = x^6 + x^4 + x^2 + x + 1
# phi4(x) = x^6 + x + 1
# g(x) = x^12 + x^10 + x^8 + x^5 + x^4 + x^3 + 1

GENERATOR_POLY = [1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1]  # g(x) = 1 + x^3 + x^4 + x^5 + x^8 + x^10 + x^12

# PHI = [[1, 1, 0, 0, 0, 0, 1],  # phi1(x) = 1 + x + x^6
#        [1, 1, 0, 0, 0, 0, 1],  # phi2(x) = 1 + x + x^6
#        [1, 1, 1, 0, 1, 0, 1],  # phi3(x) = 1 + x + x^2 + x^4 + x^6
#        [1, 1, 0, 0, 0, 0, 1]]  # phi4(x) = 1 + x + x^6

PRIMITIVE_POLY = [1, 1, 0, 0, 0, 0, 1]  # p(x) = 1 + x + x^6

T = 2  # error correction capability 
N = 63  # codeword length
K = 51  # message length
M = 6

# 預先計算 alpha 的多項式表示
# 產生方法：
# alpha^0 = 1
# alpha^i = alpha * alpha^(i-1) mod p(x)
ALPHA_POLY_BITS = [
    [1, 0, 0, 0, 0, 0],  # alpha^0 = 1
    [0, 1, 0, 0, 0, 0],  # alpha^1 = x
    [0, 0, 1, 0, 0, 0],  # alpha^2 = x^2
    [0, 0, 0, 1, 0, 0],  # alpha^3 = x^3
    [0, 0, 0, 0, 1, 0],  # alpha^4 = x^4
    [0, 0, 0, 0, 0, 1],  # alpha^5 = x^5
    [1, 1, 0, 0, 0, 0],  # alpha^6 = 1 + x
    [0, 1, 1, 0, 0, 0],  # alpha^7 = x + x^2
    [0, 0, 1, 1, 0, 0],  # alpha^8 = x^2 + x^3
    [0, 0, 0, 1, 1, 0],  # alpha^9 = x^3 + x^4
    [0, 0, 0, 0, 1, 1],  # alpha^10 = x^4 + x^5
    [1, 1, 0, 0, 0, 1],  # alpha^11 = 1 + x + x^5
    [1, 0, 1, 0, 0, 0],  # alpha^12 = 1 + x^2
    [0, 1, 0, 1, 0, 0],  # alpha^13 = x + x^3
    [0, 0, 1, 0, 1, 0],  # alpha^14 = x^2 + x^4
    [0, 0, 0, 1, 0, 1],  # alpha^15 = x^3 + x^5
    [1, 1, 0, 0, 1, 0],  # alpha^16 = 1 + x + x^4
    [0, 1, 1, 0, 0, 1],  # alpha^17 = x + x^2 + x^5
    [1, 1, 1, 1, 0, 0],  # alpha^18 = 1 + x + x^2 + x^3
    [0, 1, 1, 1, 1, 0],  # alpha^19 = x + x^2 + x^3 + x^4
    [0, 0, 1, 1, 1, 1],  # alpha^20 = x^2 + x^3 + x^4 + x^5
    [1, 1, 0, 1, 1, 1],  # alpha^21 = 1 + x + x^3 + x^4 + x^5
    [1, 0, 1, 0, 1, 1],  # alpha^22 = 1 + x^2 + x^4 + x^5
    [1, 0, 0, 1, 0, 1],  # alpha^23 = 1 + x^3 + x^5
    [1, 0, 0, 0, 1, 0],  # alpha^24 = 1 + x^4
    [0, 1, 0, 0, 0, 1],  # alpha^25 = x + x^5
    [1, 1, 1, 0, 0, 0],  # alpha^26 = 1 + x + x^2
    [0, 1, 1, 1, 0, 0],  # alpha^27 = x + x^2 + x^3
    [0, 0, 1, 1, 1, 0],  # alpha^28 = x^2 + x^3 + x^4
    [0, 0, 0, 1, 1, 1],  # alpha^29 = x^3 + x^4 + x^5
    [1, 1, 0, 0, 1, 1],  # alpha^30 = 1 + x + x^4 + x^5
    [1, 0, 1, 0, 0, 1],  # alpha^31 = 1 + x^2 + x^5
    [1, 0, 0, 1, 0, 0],  # alpha^32 = 1 + x^3
    [0, 1, 0, 0, 1, 0],  # alpha^33 = x + x^4
    [0, 0, 1, 0, 0, 1],  # alpha^34 = x^2 + x^5
    [1, 1, 0, 1, 0, 0],  # alpha^35 = 1 + x + x^3
    [0, 1, 1, 0, 1, 0],  # alpha^36 = x + x^2 + x^4
    [0, 0, 1, 1, 0, 1],  # alpha^37 = x^2 + x^3 + x^5
    [1, 1, 0, 1, 1, 0],  # alpha^38 = 1 + x + x^3 + x^4
    [0, 1, 1, 0, 1, 1],  # alpha^39 = x + x^2 + x^4 + x^5
    [1, 1, 1, 1, 0, 1],  # alpha^40 = 1 + x + x^2 + x^3 + x^5
    [1, 0, 1, 1, 1, 0],  # alpha^41 = 1 + x^2 + x^3 + x^4
    [0, 1, 0, 1, 1, 1],  # alpha^42 = x + x^3 + x^4 + x^5
    [1, 1, 1, 0, 1, 1],  # alpha^43 = 1 + x + x^2 + x^4 + x^5
    [1, 0, 1, 1, 0, 1],  # alpha^44 = 1 + x^2 + x^3 + x^5
    [1, 0, 0, 1, 1, 0],  # alpha^45 = 1 + x^3 + x^4
    [0, 1, 0, 0, 1, 1],  # alpha^46 = x + x^4 + x^5
    [1, 1, 1, 0, 0, 1],  # alpha^47 = 1 + x + x^2 + x^5
    [1, 0, 1, 1, 0, 0],  # alpha^48 = 1 + x^2 + x^3
    [0, 1, 0, 1, 1, 0],  # alpha^49 = x + x^3 + x^4
    [0, 0, 1, 0, 1, 1],  # alpha^50 = x^2 + x^4 + x^5
    [1, 1, 0, 1, 0, 1],  # alpha^51 = 1 + x + x^3 + x^5
    [1, 0, 1, 0, 1, 0],  # alpha^52 = 1 + x^2 + x^4
    [0, 1, 0, 1, 0, 1],  # alpha^53 = x + x^3 + x^5
    [1, 1, 1, 0, 1, 0],  # alpha^54 = 1 + x + x^2 + x^4
    [0, 1, 1, 1, 0, 1],  # alpha^55 = x + x^2 + x^3 + x^5
    [1, 1, 1, 1, 1, 0],  # alpha^56 = 1 + x + x^2 + x^3 + x^4
    [0, 1, 1, 1, 1, 1],  # alpha^57 = x + x^2 + x^3 + x^4 + x^5
    [1, 1, 1, 1, 1, 1],  # alpha^58 = 1 + x + x^2 + x^3 + x^4 + x^5
    [1, 0, 1, 1, 1, 1],  # alpha^59 = 1 + x^2 + x^3 + x^4 + x^5
    [1, 0, 0, 1, 1, 1],  # alpha^60 = 1 + x^3 + x^4 + x^5
    [1, 0, 0, 0, 1, 1],  # alpha^61 = 1 + x^4 + x^5
    [1, 0, 0, 0, 0, 1],  # alpha^62 = 1 + x^5
]

BITS_TO_ALPHA_EXP = {
    (1,0,0,0,0,0):  0,  # alpha^0
    (0,1,0,0,0,0):  1,  # alpha^1
    (0,0,1,0,0,0):  2,  # alpha^2
    (0,0,0,1,0,0):  3,  # alpha^3
    (0,0,0,0,1,0):  4,  # alpha^4
    (0,0,0,0,0,1):  5,  # alpha^5
    (1,1,0,0,0,0):  6,  # alpha^6
    (0,1,1,0,0,0):  7,  # alpha^7
    (0,0,1,1,0,0):  8,  # alpha^8
    (0,0,0,1,1,0):  9,  # alpha^9
    (0,0,0,0,1,1): 10,  # alpha^10
    (1,1,0,0,0,1): 11,  # alpha^11
    (1,0,1,0,0,0): 12,  # alpha^12
    (0,1,0,1,0,0): 13,  # alpha^13
    (0,0,1,0,1,0): 14,  # alpha^14
    (0,0,0,1,0,1): 15,  # alpha^15
    (1,1,0,0,1,0): 16,  # alpha^16
    (0,1,1,0,0,1): 17,  # alpha^17
    (1,1,1,1,0,0): 18,  # alpha^18
    (0,1,1,1,1,0): 19,  # alpha^19
    (0,0,1,1,1,1): 20,  # alpha^20
    (1,1,0,1,1,1): 21,  # alpha^21
    (1,0,1,0,1,1): 22,  # alpha^22
    (1,0,0,1,0,1): 23,  # alpha^23
    (1,0,0,0,1,0): 24,  # alpha^24
    (0,1,0,0,0,1): 25,  # alpha^25
    (1,1,1,0,0,0): 26,  # alpha^26
    (0,1,1,1,0,0): 27,  # alpha^27
    (0,0,1,1,1,0): 28,  # alpha^28
    (0,0,0,1,1,1): 29,  # alpha^29
    (1,1,0,0,1,1): 30,  # alpha^30
    (1,0,1,0,0,1): 31,  # alpha^31
    (1,0,0,1,0,0): 32,  # alpha^32
    (0,1,0,0,1,0): 33,  # alpha^33
    (0,0,1,0,0,1): 34,  # alpha^34
    (1,1,0,1,0,0): 35,  # alpha^35
    (0,1,1,0,1,0): 36,  # alpha^36
    (0,0,1,1,0,1): 37,  # alpha^37
    (1,1,0,1,1,0): 38,  # alpha^38
    (0,1,1,0,1,1): 39,  # alpha^39
    (1,1,1,1,0,1): 40,  # alpha^40
    (1,0,1,1,1,0): 41,  # alpha^41
    (0,1,0,1,1,1): 42,  # alpha^42
    (1,1,1,0,1,1): 43,  # alpha^43
    (1,0,1,1,0,1): 44,  # alpha^44
    (1,0,0,1,1,0): 45,  # alpha^45
    (0,1,0,0,1,1): 46,  # alpha^46
    (1,1,1,0,0,1): 47,  # alpha^47
    (1,0,1,1,0,0): 48,  # alpha^48
    (0,1,0,1,1,0): 49,  # alpha^49
    (0,0,1,0,1,1): 50,  # alpha^50
    (1,1,0,1,0,1): 51,  # alpha^51
    (1,0,1,0,1,0): 52,  # alpha^52
    (0,1,0,1,0,1): 53,  # alpha^53
    (1,1,1,0,1,0): 54,  # alpha^54
    (0,1,1,1,0,1): 55,  # alpha^55
    (1,1,1,1,1,0): 56,  # alpha^56
    (0,1,1,1,1,1): 57,  # alpha^57
    (1,1,1,1,1,1): 58,  # alpha^58
    (1,0,1,1,1,1): 59,  # alpha^59
    (1,0,0,1,1,1): 60,  # alpha^60
    (1,0,0,0,1,1): 61,  # alpha^61
    (1,0,0,0,0,1): 62,  # alpha^62
    (0,0,0,0,0,0): -1,  # ZERO
}
